# 02 å¤§å‹è¯­è¨€æ¨¡å‹

## LLMs å¦‚ä½•å·¥ä½œ?

è®©æˆ‘ä»¬çœ‹çœ‹å¤§å‹è¯­è¨€æ¨¡å‹(Large Language Models)æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œé‡ç‚¹æ˜¯ OpenAI GPTï¼ˆç”Ÿæˆå¼é¢„è®­ç»ƒ Transformerï¼‰æ¨¡å‹ã€‚

- **åˆ†è¯å™¨Tokenizerï¼Œæ–‡æœ¬åˆ°æ•°å­—**ï¼šå¤§å‹è¯­è¨€æ¨¡å‹æ¥æ”¶æ–‡æœ¬ä½œä¸ºè¾“å…¥å¹¶ç”Ÿæˆæ–‡æœ¬ä½œä¸ºè¾“å‡ºã€‚ ç„¶è€Œï¼Œä½œä¸ºç»Ÿè®¡æ¨¡å‹ï¼Œå®ƒä»¬å¯¹æ•°å­—çš„å¤„ç†æ•ˆæœå¯¹æ¯”èµ·æ–‡æœ¬åºåˆ—çš„å¤„ç†æ•ˆæœè¦å¥½å¾—å¤šã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ¨¡å‹çš„æ¯ä¸ªè¾“å…¥åœ¨è¢«æ ¸å¿ƒæ¨¡å‹ä½¿ç”¨ä¹‹å‰éƒ½ç”±åˆ†è¯å™¨å¤„ç†ã€‚ æ ‡è®°tokenæ˜¯ä¸€æ®µchunkæ–‡æœ¬â€”â€”ç”±å¯å˜æ•°é‡çš„å­—ç¬¦ç»„æˆï¼Œå› æ­¤åˆ†è¯å™¨çš„ä¸»è¦ä»»åŠ¡æ˜¯å°†è¾“å…¥åˆ†å‰²æˆtokensã€‚ ç„¶åï¼Œæ¯ä¸ªæ ‡è®°token éƒ½æ˜ å°„æœ‰ä¸€ä¸ªç´¢å¼•ï¼Œè¯¥ç´¢å¼•æ˜¯åŸå§‹æ–‡æœ¬å—chunkçš„æ•´æ•°ç¼–ç ã€‚

![Example of tokenization](./02_LLM.assets/tokenizer-example.pngWT-1703175122317-2.png)

- **é¢„æµ‹è¾“å‡ºæ ‡è®°**ï¼šç»™å®š n ä¸ªæ ‡è®°ä½œä¸ºè¾“å…¥ï¼ˆæœ€å¤§ n å› æ¨¡å‹è€Œå¼‚ï¼‰ï¼Œæ¨¡å‹èƒ½å¤Ÿé¢„æµ‹ä¸€ä¸ªæ ‡è®°ä½œä¸ºè¾“å‡ºã€‚ ç„¶åï¼Œè¯¥æ ‡è®°ä¼šä»¥æ‰©å±•çª—å£æ¨¡å¼åˆå¹¶åˆ°ä¸‹ä¸€æ¬¡è¿­ä»£çš„è¾“å…¥ä¸­ï¼Œä»è€Œè·å¾—ä¸€ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰å¥å­ä½œä¸ºç­”æ¡ˆ,ç”Ÿæˆç»“æœæœ‰æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚ è¿™è§£é‡Šäº†ä¸ºä»€ä¹ˆå¦‚æœæ‚¨æ›¾ç»ä½¿ç”¨è¿‡ ChatGPTï¼Œæ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°æœ‰æ—¶å®ƒåœ¨ç”Ÿæˆç»“æœæ—¶åœ¨å¥å­ä¸­é—´å‡ºç°åœé¡¿ã€‚

- **é€‰æ‹©è¿‡ç¨‹ï¼Œæ¦‚ç‡åˆ†å¸ƒ**ï¼šæ¨¡å‹æ ¹æ®å…¶åœ¨å½“å‰æ–‡æœ¬åºåˆ—ä¹‹åå‡ºç°çš„æ¦‚ç‡æ¥é€‰æ‹©è¾“å‡ºæ ‡è®°ã€‚ è¿™æ˜¯å› ä¸ºè¯¥æ¨¡å‹é¢„æµ‹äº†æ ¹æ®å…¶è®­ç»ƒè®¡ç®—å‡ºçš„æ‰€æœ‰å¯èƒ½çš„â€œä¸‹ä¸€ä¸ªæ ‡è®°â€çš„æ¦‚ç‡åˆ†å¸ƒã€‚ ç„¶è€Œï¼Œå¹¶ä¸æ€»æ˜¯ä»ç»“æœåˆ†å¸ƒä¸­é€‰æ‹©æ¦‚ç‡æœ€é«˜çš„æ ‡è®°ã€‚ è¿™ç§é€‰æ‹©å¢åŠ äº†ä¸€å®šç¨‹åº¦çš„éšæœºæ€§ï¼Œæ¨¡å‹ä»¥éç¡®å®šæ€§æ–¹å¼è¿è¡Œâ€”â€”å¯¹äºç›¸åŒçš„è¾“å…¥ï¼Œæˆ‘ä»¬ä¸ä¼šå¾—åˆ°å®Œå…¨ç›¸åŒçš„è¾“å‡ºã€‚ æ·»åŠ è¿™ç§ç¨‹åº¦çš„éšæœºæ€§æ˜¯ä¸ºäº†æ¨¡æ‹Ÿäººç±»åˆ›é€ æ€§æ€ç»´çš„è¿‡ç¨‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç§°ä¸ºæ¸©åº¦temperatureçš„æ¨¡å‹å‚æ•°è¿›è¡Œè°ƒæ•´ã€‚

  - >"æ¸©åº¦"å‚æ•°ç”¨äºæ§åˆ¶ç”Ÿæˆæ–‡æœ¬çš„éšæœºæ€§æˆ–åˆ›é€ æ€§ã€‚è¿™ä¸ªå‚æ•°é€šå¸¸è®¾ç½®åœ¨0åˆ°1ä¹‹é—´ã€‚è®©æˆ‘ä¸ºä½ è§£é‡Šå®ƒçš„å·¥ä½œåŸç†ï¼š
    >
    >1. **æ¸©åº¦ä¸º0**ï¼šåœ¨è¿™ç§è®¾ç½®ä¸‹ï¼Œæ¨¡å‹å°†å§‹ç»ˆé€‰æ‹©æ¦‚ç‡æœ€é«˜çš„ä¸‹ä¸€ä¸ªè¯ã€‚è¿™æ„å‘³ç€ç”Ÿæˆçš„æ–‡æœ¬ä¼šéå¸¸ä¸€è‡´å’Œå¯é¢„æµ‹ï¼Œä½†å¯èƒ½ç¼ºä¹åˆ›é€ æ€§å’Œå¤šæ ·æ€§ã€‚
    >
    >2. **æ¸©åº¦ä¸º1**ï¼šè¿™æ˜¯æ ‡å‡†è®¾ç½®ï¼Œæ¨¡å‹åœ¨é€‰æ‹©ä¸‹ä¸€ä¸ªè¯æ—¶ä¼šè€ƒè™‘å¤šç§å¯èƒ½æ€§ï¼Œå³ä½¿æŸäº›è¯çš„æ¦‚ç‡ç¨ä½ã€‚è¿™æé«˜äº†æ–‡æœ¬çš„å¤šæ ·æ€§å’Œåˆ›é€ æ€§ï¼Œä½†åŒæ—¶å¯èƒ½å¢åŠ äº†ç”ŸæˆæŸäº›ä¸é‚£ä¹ˆå‡†ç¡®æˆ–ä¸ç›¸å…³å†…å®¹çš„é£é™©ã€‚
    >
    >3. **æ¸©åº¦å¤§äº1**ï¼šåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¨¡å‹åœ¨ç”Ÿæˆæ–‡æœ¬æ—¶ä¼šæ›´åŠ éšæœºå’Œåˆ›é€ æ€§ï¼Œç”šè‡³å¯èƒ½é€‰æ‹©é‚£äº›åœ¨å¸¸è§„æƒ…å†µä¸‹ä¸å¤ªå¯èƒ½å‡ºç°çš„è¯ã€‚è¿™å¯ä»¥ç”¨äºç”Ÿæˆæ›´åŠ åŸåˆ›å’Œéå¸¸è§„çš„å†…å®¹ï¼Œä½†åŒæ—¶ä¹Ÿå¯èƒ½å¯¼è‡´æ–‡æœ¬è´¨é‡ä¸‹é™ï¼ŒåŒ…æ‹¬è¯­æ³•é”™è¯¯å’Œä¸ç›¸å…³å†…å®¹çš„å¢åŠ ã€‚
    >
    >æ€»çš„æ¥è¯´ï¼Œæ¸©åº¦å‚æ•°æ˜¯ä¸€ç§å¹³è¡¡åˆ›é€ æ€§å’Œå‡†ç¡®æ€§çš„å·¥å…·ã€‚ä½æ¸©åº¦å€¾å‘äºäº§ç”Ÿæ›´å‡†ç¡®ã€æ›´å¯é¢„æµ‹çš„è¾“å‡ºï¼Œè€Œé«˜æ¸©åº¦åˆ™å¢åŠ äº†éšæœºæ€§å’Œåˆ›é€ æ€§ã€‚

## ä¸åŒçš„LLMs

å¤§å‹è¯­è¨€æ¨¡å‹ (LLM) å¯ä»¥æ ¹æ®å…¶æ¶æ„ã€è®­ç»ƒæ•°æ®å’Œç”¨ä¾‹è¿›è¡Œå¤šç§åˆ†ç±»ã€‚ äº†è§£è¿™äº›å·®å¼‚å°†æœ‰åŠ©äºä½ æ ¹æ®åœºæ™¯é€‰æ‹©æ­£ç¡®çš„æ¨¡å‹ï¼Œå¹¶äº†è§£å¦‚ä½•æµ‹è¯•ã€è¿­ä»£å’Œæé«˜æ€§èƒ½ã€‚

LLM æ¨¡å‹æœ‰è®¸å¤šä¸åŒç±»å‹ï¼Œæ‚¨é€‰æ‹©çš„æ¨¡å‹å–å†³äºæ‚¨çš„ç”¨é€”ã€æ‚¨çš„æ•°æ®ã€æ‚¨å‡†å¤‡æ”¯ä»˜çš„è´¹ç”¨ç­‰ç­‰ã€‚

æ ¹æ®æ‚¨æ˜¯å¦æ‰“ç®—ä½¿ç”¨æ¨¡å‹è¿›è¡Œæ–‡æœ¬ã€éŸ³é¢‘ã€è§†é¢‘ã€å›¾åƒç”Ÿæˆç­‰ï¼Œæ‚¨å¯èƒ½ä¼šé€‰æ‹©ä¸åŒç±»å‹çš„æ¨¡å‹ã€‚

- **éŸ³é¢‘å’Œè¯­éŸ³è¯†åˆ«**ã€‚ ä¸ºæ­¤ï¼ŒWhisper æ¨¡å‹æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒä»¬æ˜¯é€šå¸¸ç”¨äºè¯­éŸ³è¯†åˆ«ã€‚ å®ƒç»è¿‡ä¸åŒéŸ³é¢‘æ•°æ®çš„è®­ç»ƒï¼Œå¯ä»¥æ‰§è¡Œå¤šè¯­è¨€è¯­éŸ³è¯†åˆ«ã€‚ ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ‰€æœ‰çš„æ¨¡å‹ï¼Œä»ä»·æ ¼ä¾¿å®œä½†åŠŸèƒ½å¼ºå¤§çš„æ¨¡å‹ï¼ˆå¦‚ Curryï¼‰åˆ°æ›´æ˜‚è´µæ‹¥æœ‰é«˜æ€§èƒ½çš„è¾¾èŠ¬å¥‡ï¼ˆDavinciï¼‰æ¨¡å‹ã€‚ è¯¦ç»†äº†è§£ [Whisper ç±»å‹æ¨¡å‹](https://platform.openai.com/docs/models/whisper?WT.mc_id=academic-105485-koreyst)ã€‚
- **å›¾åƒç”Ÿæˆ**ã€‚ å¯¹äºå›¾åƒç”Ÿæˆï¼ŒDALL-E å’Œ Midjourney æ˜¯ä¸¤ä¸ªæœ€ä½³çš„é€‰æ‹©ã€‚ DALL-E ç”± OpenAI æä¾›ã€‚ [åœ¨æ­¤å¤„é˜…è¯»æœ‰å…³ DALL-E çš„æ›´å¤šä¿¡æ¯](https://platform.openai.com/docs/models/dall-e?WT.mc_id=academic-105485-koreyst) ã€‚
- **æ–‡æœ¬ç”Ÿæˆ**ã€‚ å¤§å¤šæ•°æ¨¡å‹éƒ½ç»è¿‡æ–‡æœ¬ç”Ÿæˆè®­ç»ƒï¼Œæ‚¨æœ‰ä» GPT-3.5 åˆ° GPT-4 çš„å¤šç§é€‰æ‹©ã€‚ å®ƒä»¬çš„æˆæœ¬å„ä¸åŒï¼Œå…¶ä¸­ GPT-4 æ˜¯æœ€æ˜‚è´µçš„ã€‚

é€‰æ‹©æ¨¡å‹æ„å‘³ç€æ‚¨èƒ½è·å¾—ä¸€äº›åŸºæœ¬åŠŸèƒ½ï¼Œä½†è¿™å¯èƒ½è¿˜ä¸å¤Ÿã€‚ é€šå¸¸ï¼Œæ‚¨æœ‰å…¬å¸ç‰¹å®šçš„æ•°æ®ï¼Œæ‚¨éœ€è¦ä»¥æŸç§æ–¹å¼å‘Šè¯‰ LLMsã€‚ å…³äºå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ‰å‡ ç§ä¸åŒçš„é€‰æ‹©ï¼Œæ¥ä¸‹æ¥çš„éƒ¨åˆ†å°†è¯¦ç»†ä»‹ç»ã€‚

### åŸºç¡€æ¨¡å‹

â€œåŸºç¡€æ¨¡å‹â€æ˜¯[ç”±æ–¯å¦ç¦å¤§å­¦ç ”ç©¶äººå‘˜åˆ›é€ ](https://arxiv.org/abs/2108.07258?WT.mc_id=academic-105485-koreyst)ï¼Œå®šä¹‰ä¸ºéµå¾ªæŸäº›æ ‡å‡†çš„äººå·¥æ™ºèƒ½æ¨¡å‹ï¼Œä¾‹å¦‚ï¼š

- **ä»–ä»¬ä½¿ç”¨æ— ç›‘ç£å­¦ä¹ æˆ–è‡ªç›‘ç£å­¦ä¹ è¿›è¡Œè®­ç»ƒ**ï¼Œè¿™æ„å‘³ç€ä»–ä»¬æ¥å—æœªæ ‡è®°çš„å¤šæ¨¡å¼æ•°æ®çš„è®­ç»ƒï¼Œå¹¶ä¸”ä»–ä»¬çš„è®­ç»ƒè¿‡ç¨‹ä¸éœ€è¦äººå·¥æ³¨é‡Šæˆ–æ•°æ®æ ‡è®°ã€‚
- **å®ƒä»¬æ˜¯éå¸¸å¤§çš„æ¨¡å‹**ï¼ŒåŸºäºç»è¿‡æ•°åäº¿å‚æ•°è®­ç»ƒçš„æ·±åº¦ç¥ç»ç½‘ç»œã€‚
- **å®ƒä»¬é€šå¸¸æ—¨åœ¨ä½œä¸ºå…¶ä»–æ¨¡å‹çš„â€œåŸºç¡€â€**ï¼Œè¿™æ„å‘³ç€å®ƒä»¬å¯ä»¥ç”¨ä½œæ„å»ºå…¶ä»–æ¨¡å‹çš„èµ·ç‚¹ï¼Œå¯ä»¥é€šè¿‡å¾®è°ƒæ–¹å¼æ¥å®Œæˆã€‚

![åŸºç¡€æ¨¡å‹ä¸ LLMs](./02_LLM.assets/FoundationModel.pngWT.png)

å›¾ç‰‡æ¥æº: [Essential Guide to Foundation Models and Large Language Models | by Babar M Bhatti | Medium](https://thebabar.medium.com/essential-guide-to-foundation-models-and-large-language-models-27dab58f7404)

ä¸ºäº†è¿›ä¸€æ­¥é˜æ˜è¿™ç§åŒºåˆ«ï¼Œæˆ‘ä»¬ä»¥ ChatGPT ä¸ºä¾‹ã€‚ ä¸ºäº†æ„å»º ChatGPT çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼Œåä¸º GPT-3.5 çš„æ¨¡å‹ä½œä¸ºåŸºç¡€æ¨¡å‹ã€‚ è¿™æ„å‘³ç€ OpenAI ä½¿ç”¨ä¸€äº›ç‰¹å®šäºèŠå¤©çš„æ•°æ®æ¥åˆ›å»º GPT-3.5 çš„è°ƒæ•´ç‰ˆæœ¬ï¼Œä¸“é—¨ç”¨äºåœ¨å¯¹è¯åœºæ™¯ï¼ˆä¾‹å¦‚èŠå¤©æœºå™¨äººï¼‰ä¸­è®©å…¶æœ‰æ›´å¥½çš„è¡¨ç°ã€‚

![image-20231222003545113](./02_LLM.assets/image-20231222003545113.png)

å›¾ç‰‡æ¥æº: [2108.07258.pdf (arxiv.org)](https://arxiv.org/pdf/2108.07258.pdf?WT.mc_id=academic-105485-koreyst)

### å¼€æºæ¨¡å‹ä¸ä¸“æœ‰æ¨¡å‹

å¯¹ LLM è¿›è¡Œåˆ†ç±»çš„å¦ä¸€ç§æ–¹æ³•æ˜¯å®ƒä»¬æ˜¯å¼€æºçš„è¿˜æ˜¯ä¸“æœ‰proprietaryçš„ã€‚

å¼€æºæ¨¡å‹æ˜¯å‘å…¬ä¼—å¼€æ”¾å¹¶ä¸”ä»»ä½•äººéƒ½å¯ä»¥ä½¿ç”¨çš„æ¨¡å‹ã€‚ å®ƒä»¬é€šå¸¸ç”±åˆ›å»ºå®ƒä»¬çš„å…¬å¸æˆ–ç ”ç©¶å›¢ä½“æä¾›ã€‚ è¿™äº›æ¨¡å‹å¯ä»¥é’ˆå¯¹ LLMs çš„å„ç§ç”¨ä¾‹è¿›è¡Œæ£€æŸ¥ã€ä¿®æ”¹å’Œå®šåˆ¶ã€‚ ç„¶è€Œï¼Œå®ƒä»¬å¹¶ä¸æ€»æ˜¯é’ˆå¯¹ç”Ÿäº§ç”¨é€”è¿›è¡Œä¼˜åŒ–ï¼Œå¹¶ä¸”å¯èƒ½ä¸å¦‚ä¸“æœ‰æ¨¡å‹å…·å¤‡é«˜æ€§èƒ½ã€‚æ­¤å¤–ï¼Œå¼€æºæ¨¡å‹çš„èµ„é‡‘å¯èƒ½æœ‰é™ï¼Œå¹¶ä¸”å®ƒä»¬å¯èƒ½æ— æ³•é•¿æœŸç»´æŠ¤æˆ–å¯èƒ½æ— æ³•æ ¹æ®æœ€æ–°ç ”ç©¶è¿›è¡Œæ›´æ–°ã€‚ æµè¡Œçš„å¼€æºæ¨¡å‹çš„ä¾‹å­åŒ…æ‹¬ [Alpaca](https://crfm.stanford.edu/2023/03/13/alpaca.html)ã€[Bloom](https://sapling.ai/llm/bloom) å’Œ [LLaMA](https://sapling.ai/llm/llama?WT.mc_id=academic-105485-koreyst)ã€‚

ä¸“æœ‰æ¨¡å‹æ˜¯å…¬å¸æ‹¥æœ‰çš„æ¨¡å‹ï¼Œä¸å‘å…¬ä¼—æä¾›ã€‚ è¿™äº›æ¨¡å‹é€šå¸¸é’ˆå¯¹ç”Ÿäº§ç”¨é€”è¿›è¡Œäº†ä¼˜åŒ–ã€‚ ä½†æ˜¯ï¼Œä¸å…è®¸é’ˆå¯¹ç‰¹å®šçš„ä½¿ç”¨åœºæ™¯è¿›è¡Œæ£€æŸ¥ã€ä¿®æ”¹æˆ–å®šåˆ¶å®ƒä»¬ã€‚ å¦å¤–ï¼Œå®ƒä»¬å¹¶ä¸æ€»æ˜¯å…è´¹æä¾›ï¼Œå¯èƒ½éœ€è¦è®¢é˜…æˆ–ä»˜è´¹æ‰èƒ½ä½¿ç”¨ã€‚ æ­¤å¤–ï¼Œç”¨æˆ·æ— æ³•æ§åˆ¶ç”¨äºè®­ç»ƒæ¨¡å‹çš„æ•°æ®ï¼Œè¿™æ„å‘³ç€ä»–ä»¬åº”è¯¥å§”æ‰˜æ¨¡å‹æ‰€æœ‰è€…ç¡®ä¿å¯¹æ•°æ®éšç§å’Œè´Ÿè´£ä»»åœ°ä½¿ç”¨äººå·¥æ™ºèƒ½çš„æ‰¿è¯ºã€‚ æµè¡Œçš„ä¸“æœ‰æ¨¡å‹çš„ä¾‹å­åŒ…æ‹¬ [OpenAI æ¨¡å‹](https://platform.openai.com/docs/models/overview)ã€[Google Bard](https://sapling.ai/llm/bard?WT.mc_id=academic-105485-koreyst) æˆ– [Claude 2]( https://www.anthropic.com/index/claude-2)ã€‚

### åµŒå…¥ã€å›¾åƒç”Ÿæˆã€æ–‡æœ¬å’Œä»£ç ç”Ÿæˆ

LLMs è¿˜å¯ä»¥æ ¹æ®å…¶äº§ç”Ÿçš„è¾“å‡ºè¿›è¡Œåˆ†ç±»ã€‚

**åµŒå…¥Embeddings**æ˜¯ä¸€ç»„å¯ä»¥å°†æ–‡æœ¬è½¬æ¢ä¸ºæ•°å­—å½¢å¼çš„æ¨¡å‹ï¼Œç§°ä¸ºåµŒå…¥ï¼Œå®ƒæ˜¯è¾“å…¥æ–‡æœ¬çš„æ•°å­—è¡¨ç¤ºã€‚ åµŒå…¥ä½¿æœºå™¨æ›´å®¹æ˜“ç†è§£å•è¯æˆ–å¥å­ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶ä¸”å¯ä»¥ç”¨ä½œå…¶ä»–æ¨¡å‹çš„è¾“å…¥ï¼Œä¾‹å¦‚åˆ†ç±»æ¨¡å‹æˆ–å¯¹æ•°å€¼æ•°æ®å…·æœ‰æ›´å¥½æ€§èƒ½çš„èšç±»æ¨¡å‹ã€‚ åµŒå…¥æ¨¡å‹é€šå¸¸ç”¨äºè¿ç§»å­¦ä¹ ï¼Œå…¶ä¸­ä¸ºæœ‰å¤§é‡æ•°æ®çš„ä»£ç†ä»»åŠ¡æ„å»ºæ¨¡å‹ï¼Œç„¶åå°†æ¨¡å‹æƒé‡ï¼ˆåµŒå…¥ï¼‰é‡æ–°ç”¨äºå…¶ä»–ä¸‹æ¸¸ä»»åŠ¡ã€‚ æ­¤ç±»åˆ«çš„ä¸€ä¸ªç¤ºä¾‹æ˜¯ [OpenAI åµŒå…¥](https://platform.openai.com/docs/models/embeddings?WT.mc_id=academic-105485-koreyst)ã€‚

![åµŒå…¥](./02_LLM.assets/Embedding.pngWT.png)

**å›¾åƒ**ç”Ÿæˆæ¨¡å‹ä¸»è¦æ˜¯ç”¨æ¥ç”Ÿæˆå›¾åƒã€‚ è¿™äº›æ¨¡å‹é€šå¸¸ç”¨äºå›¾åƒç¼–è¾‘ã€å›¾åƒåˆæˆå’Œå›¾åƒç¿»è¯‘ã€‚ å›¾åƒç”Ÿæˆæ¨¡å‹é€šå¸¸åœ¨å¤§å‹å›¾åƒæ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒï¼Œä¾‹å¦‚ [LAION-5B](https://laion.ai/blog/laion-5b/?WT.mc_id=academic-105485-koreyst)ï¼Œå¹¶ä¸”å¯ç”¨äºç”Ÿæˆæ–°å›¾åƒæˆ–ç¼–è¾‘ç°æœ‰å›¾åƒ ä¿®å¤ã€è¶…åˆ†è¾¨ç‡å’Œç€è‰²æŠ€æœ¯ã€‚ å¦‚ [DALL-E-3](https://openai.com/dall-e-3) å’Œ [StableDiffusion](https://github.com/Stability-AI/StableDiffusion?WT.mc_id=academic-105485-koreyst)ã€‚

![Image generation](./02_LLM.assets/Image.pngWT.png)

**æ–‡æœ¬æˆ–ä»£ç **ç”Ÿæˆæ¨¡å‹ä¸»è¦æ˜¯ç”Ÿæˆæ–‡æœ¬æˆ–ä»£ç ã€‚ è¿™äº›æ¨¡å‹é€šå¸¸ç”¨äºæ–‡æœ¬æ‘˜è¦ã€ç¿»è¯‘å’Œé—®ç­”ã€‚ æ–‡æœ¬ç”Ÿæˆæ¨¡å‹é€šå¸¸åœ¨å¤§å‹æ–‡æœ¬æ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒï¼Œä¾‹å¦‚ [BookCorpus](https://www.cv-foundation.org/openaccess/content_iccv_2015/html/Zhu_Aligning_Books_and_ICCV_2015_paper.html)ï¼Œå¹¶ä¸”å¯ç”¨äºç”Ÿæˆæ–°æ–‡æœ¬æˆ–å›ç­”é—®é¢˜ã€‚ ä»£ç ç”Ÿæˆæ¨¡å‹ï¼Œä¾‹å¦‚ [CodeParrot](https://huggingface.co/codeparrot?WT.mc_id=academic-105485-koreyst)ï¼Œé€šå¸¸åœ¨å¤§å‹ä»£ç æ•°æ®é›†ï¼ˆå¦‚ GitHubï¼‰ä¸Šè¿›è¡Œè®­ç»ƒï¼Œå¯ç”¨äºç”Ÿæˆæ–°ä»£ç æˆ–ä¿®å¤ç°æœ‰ä»£ç ä¸­çš„é”™è¯¯ã€‚

![Text and code generation](./02_LLM.assets/Text.pngWT.png)

### ç¼–ç -è§£ç å™¨ä¸ç‹¬ç«‹è§£ç å™¨

ä¸ºäº†è®¨è®º LLMs çš„ä¸åŒç±»å‹çš„æ¶æ„ï¼Œè®©æˆ‘ä»¬æ¥æ‰“ä¸ªæ¯”æ–¹ã€‚

æƒ³è±¡ä¸€ä¸‹ï¼Œæ‚¨çš„ç»ç†ç»™æ‚¨ä¸€ä¸ªä¸ºå­¦ç”Ÿç¼–å†™æµ‹éªŒé¢˜ç›®çš„ä»»åŠ¡ã€‚ æ‚¨æœ‰ä¸¤ä¸ªåŒäº‹ï¼› ä¸€åè´Ÿè´£ç›‘ç£å†…å®¹çš„åˆ›å»ºï¼Œå¦ä¸€åè´Ÿè´£å®¡æŸ¥å†…å®¹ã€‚

å†…å®¹åˆ›å»ºè€…å°±åƒä¸€ä¸ªç‹¬ç«‹**è§£ç å™¨**çš„æ¨¡å‹ï¼Œä»–ä»¬å¯ä»¥æŸ¥çœ‹ä¸»é¢˜å¹¶æŸ¥çœ‹æ‚¨å·²ç»å†™çš„å†…å®¹ï¼Œç„¶åä»–å¯ä»¥åŸºäºè¿™äº›å†…å®¹æ¥ç¼–å†™è¯¾ç¨‹ã€‚ ä»–ä»¬éå¸¸æ“…é•¿æ’°å†™å¼•äººå…¥èƒœä¸”å†…å®¹ä¸°å¯Œçš„å†…å®¹ï¼Œä½†ä¸å¤ªæ“…é•¿ç†è§£ä¸»é¢˜å’Œå­¦ä¹ ç›®æ ‡ã€‚ ç‹¬ç«‹è§£ç å™¨æ¨¡å‹å¦‚ GPT ç³»åˆ—æ¨¡å‹ï¼Œä¾‹å¦‚ GPT-3ã€‚

å®¡é˜…è€…å°±åƒä¸€ä¸ªç‹¬ç«‹**ç¼–ç å™¨**çš„æ¨¡å‹ï¼Œä»–ä»¬æŸ¥çœ‹ç¼–å†™çš„è¯¾ç¨‹å’Œç­”æ¡ˆï¼Œæ³¨æ„å®ƒä»¬ä¹‹é—´çš„å…³ç³»å¹¶é€šè¿‡ä¸Šä¸‹æ–‡è¿›è¡Œç†è§£ï¼Œä½†ä»–ä»¬ä¸æ“…äºç”Ÿæˆå†…å®¹ã€‚ç‹¬ç«‹ç¼–ç å™¨æ¨¡å‹çš„ä¸€ä¸ªä¾‹å­æ˜¯ BERTã€‚

æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æœ‰äººå¯ä»¥åˆ›å»ºå’Œå®¡æŸ¥æµ‹éªŒï¼Œè¿™æ˜¯ä¸€ä¸ªç¼–ç å™¨-è§£ç å™¨Encoder-Decoderæ¨¡å‹å¦‚ BART å’Œ T5

### æœåŠ¡ä¸æ¨¡å‹

ç°åœ¨ï¼Œæˆ‘ä»¬æ¥è°ˆè°ˆæœåŠ¡å’Œæ¨¡å‹ä¹‹é—´çš„åŒºåˆ«ã€‚ æœåŠ¡æ˜¯äº‘æœåŠ¡æä¾›å•†æä¾›çš„äº§å“ï¼Œé€šå¸¸æ˜¯æ¨¡å‹ã€æ•°æ®å’Œå…¶ä»–ç»„ä»¶çš„ç»“åˆã€‚ æ¨¡å‹æ˜¯æœåŠ¡çš„æ ¸å¿ƒç»„ä»¶ï¼Œé€šå¸¸æ˜¯åŸºç¡€æ¨¡å‹ï¼Œä¾‹å¦‚å„ç§ LLMã€‚

æœåŠ¡é€šå¸¸é’ˆå¯¹ç”Ÿäº§ç¯å¢ƒè¿›è¡Œäº†ä¼˜åŒ–ï¼Œå¹¶ä¸”é€šå¸¸æ¯”æ¨¡å‹è®©ç”¨æˆ·é€šè¿‡å›¾å½¢ç•Œé¢æ›´å®¹æ˜“ä½¿ç”¨ã€‚ ä½†æœåŠ¡å¹¶ä¸æ€»æ˜¯å…è´¹æä¾›çš„ï¼Œå¯èƒ½éœ€è¦è®¢é˜…æˆ–ä»˜è´¹æ‰èƒ½ä½¿ç”¨ï¼Œä»¥æ¢å–æœåŠ¡æ‰€æœ‰è€…çš„è®¾å¤‡å’Œç›¸å…³èµ„æºï¼Œä¼˜åŒ–è´¹ç”¨å¹¶è½»æ¾æ‰©å±•ã€‚ æœåŠ¡çš„ä¸€ä¸ªä¾‹å­æ˜¯ [Azure OpenAI æœåŠ¡](https://learn.microsoft.com/azure/ai-services/openai/overview?WT.mc_id=academic-105485-koreyst)ï¼Œå®ƒæä¾›æŒ‰éœ€ä»˜è´¹è®¡åˆ’ï¼Œæ„å‘³ç€ç”¨æˆ·æ ¹æ®æœåŠ¡ç”¨é‡ä»˜è´¹ã€‚æ­¤å¤–ï¼ŒAzure OpenAI Service åœ¨æ¨¡å‹åŠŸèƒ½ä¸Šè¿˜æä¾›ä¼ä¸šçº§å®‰å…¨æ€§å’Œè´Ÿè´£ä»»çš„ AI æ¡†æ¶ã€‚

æ¨¡å‹æ˜¯å¸¦æœ‰å‚æ•°ã€æƒé‡ç­‰çš„ç¥ç»ç½‘ç»œã€‚ å…è®¸å…¬å¸åœ¨æœ¬åœ°è¿è¥éœ€è¦è´­ä¹°è®¾å¤‡ã€æ„å»ºå¹¶è´­ä¹°è®¸å¯è¯æˆ–ä½¿ç”¨å¼€æºæ¨¡å‹ã€‚ åƒ LLaMA è¿™æ ·çš„æ¨¡å‹ä½¿ç”¨å°±éœ€è¦é¢å¤–çš„ç®—åŠ›è¿è¡Œã€‚

## æå‡ LLM çš„è¾“å‡ºç»“æœå‡†ç¡®åº¦

ä»€ä¹ˆæ—¶å€™åº”è¯¥è€ƒè™‘å¾®è°ƒæ¨¡å‹è€Œä¸æ˜¯ä½¿ç”¨é¢„å…ˆè®­ç»ƒçš„æ¨¡å‹å‘¢ï¼Ÿ æ˜¯å¦æœ‰å…¶ä»–æ–¹æ³•å¯ä»¥æé«˜æ¨¡å‹åœ¨ç‰¹å®šå·¥ä½œè´Ÿè½½workloadä¸Šçš„æ€§èƒ½ï¼Ÿ

ä¼ä¸šå¯ä»¥ä½¿ç”¨å¤šç§æ–¹æ³•ä» LLMs è·å¾—æ‰€éœ€çš„ç»“æœï¼Œæ‚¨å¯ä»¥é€‰æ‹©å…·æœ‰ä¸åŒè®­ç»ƒç¨‹åº¦çš„ä¸åŒç±»å‹çš„æ¨¡å‹ã€‚

åœ¨ç”Ÿäº§ä¸­éƒ¨ç½² LLMs ï¼Œå…·æœ‰ä¸åŒç¨‹åº¦çš„å¤æ‚æ€§ã€æˆæœ¬å’Œè´¨é‡ã€‚ ä»¥ä¸‹æ˜¯ä¸€äº›ä¸åŒçš„æ–¹æ³•ï¼š

- **æ ¹æ®ä¸Šä¸‹æ–‡çš„æç¤ºå·¥ç¨‹**ã€‚ è¿™ä¸ªæƒ³æ³•æ˜¯åœ¨æç¤ºæ—¶æä¾›è¶³å¤Ÿçš„èƒŒæ™¯ä¿¡æ¯ï¼Œä»¥ç¡®ä¿è·å¾—æ‰€éœ€çš„ç»“æœã€‚
- **æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ŒRAG**ã€‚ ä¾‹å¦‚ï¼Œæ‚¨çš„æ•°æ®å¯èƒ½å­˜åœ¨äºå‘é‡æ•°æ®åº“æˆ– Web ç«¯ç‚¹ä¸­ï¼Œä¸ºäº†ç¡®ä¿åœ¨æç¤ºæ—¶åŒ…å«æ­¤æ•°æ®æˆ–å…¶å­é›†ï¼Œæ‚¨å¯ä»¥è·å–ç›¸å…³æ•°æ®å¹¶å¯¹ç”¨æˆ·è¿›è¡Œæç¤ºã€‚
- **å¾®è°ƒæ¨¡å‹**ã€‚ åœ¨è¿™é‡Œï¼Œæ‚¨æ ¹æ®è‡ªå·±çš„æ•°æ®è¿›ä¸€æ­¥è®­ç»ƒæ¨¡å‹ï¼Œè¿™ä½¿å¾—æ¨¡å‹æ›´åŠ å‡†ç¡®å¹¶ä¸”èƒ½å¤Ÿå“åº”æ‚¨çš„éœ€æ±‚ï¼Œä½†å¯èƒ½æˆæœ¬é«˜æ˜‚ã€‚

![LLMs deployment](./02_LLM.assets/Deploy.pngWT.png)

å›¾ç‰‡æ¥æº: [ä¼ä¸šéƒ¨ç½²LLMçš„å››ç§æ–¹å¼| Fiddler AI åšå®¢](https://www.fiddler.ai/blog/four-ways-that-enterprises-deploy-llms?WT.mc_id=academic-105485-koreyst)

### é€šè¿‡ä¸Šä¸‹æ–‡çš„æç¤ºå·¥ç¨‹

é¢„å…ˆè®­ç»ƒçš„ LLMs åœ¨å¹¿ä¹‰è‡ªç„¶è¯­è¨€ä»»åŠ¡ä¸Šè¡¨ç°å¾—éå¸¸å¥½ï¼Œç”šè‡³å¯ä»¥ç”¨ç®€çŸ­çš„æç¤ºæ¥è°ƒç”¨å®ƒä»¬ï¼Œæ¯”å¦‚è¦å®Œæˆçš„å¥å­æˆ–é—®é¢˜â€”â€”å³æ‰€è°“çš„â€œé›¶æ ·æœ¬â€å­¦ä¹ ã€‚

ç„¶è€Œï¼Œç”¨æˆ·è¶Šèƒ½é€šè¿‡è¯¦ç»†çš„è¯·æ±‚å’Œç¤ºä¾‹ï¼ˆä¸Šä¸‹æ–‡ï¼‰æ¥æ„å»ºä»–ä»¬çš„æŸ¥è¯¢ï¼Œå°±ä¼šå¾—åˆ°æœ€å‡†ç¡®ã€æœ€æ¥è¿‘ç”¨æˆ·æœŸæœ›çš„ç­”æ¡ˆã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæç¤ºä»…åŒ…å«ä¸€ä¸ªç¤ºä¾‹ï¼Œæˆ‘ä»¬è®¨è®ºâ€œå•æ ·æœ¬â€å­¦ä¹ ï¼›å¦‚æœæç¤ºåŒ…å«å¤šä¸ªç¤ºä¾‹ï¼Œæˆ‘ä»¬è®¨è®ºâ€œå°‘æ ·æœ¬å­¦ä¹ â€ã€‚

æ ¹æ®ä¸Šä¸‹æ–‡è¿›è¡Œå¿«é€Ÿå·¥ç¨‹è®¾è®¡æ˜¯æœ€å…·æˆæœ¬æ•ˆç›Šçš„å¯åŠ¨æ–¹æ³•ã€‚

### æ£€ç´¢å¢å¼ºç”Ÿæˆ (Retrieval Augmented Generationï¼ŒRAG)

LLMs æœ‰ä¸€ä¸ªé™åˆ¶ï¼Œå³ä»–ä»¬åªèƒ½ä½¿ç”¨è®­ç»ƒæœŸé—´ä½¿ç”¨è¿‡çš„æ•°æ®æ¥ç”Ÿæˆç­”æ¡ˆã€‚ è¿™æ„å‘³ç€ä»–ä»¬å¯¹è®­ç»ƒè¿‡ç¨‹åå‘ç”Ÿçš„äº‹æƒ…ä¸€æ— æ‰€çŸ¥ï¼Œå¹¶ä¸”æ— æ³•è®¿é—®éå…¬å¼€ä¿¡æ¯ï¼ˆä¾‹å¦‚å…¬å¸æ•°æ®ï¼‰ã€‚ è¿™å¯ä»¥é€šè¿‡ RAG æ¥å…‹æœï¼ŒRAG æ˜¯ä¸€ç§è€ƒè™‘æç¤ºé•¿åº¦é™åˆ¶çš„æŠ€æœ¯ï¼Œä»¥æ–‡æ¡£å—çš„å½¢å¼ä½¿ç”¨å¤–éƒ¨æ•°æ®æ¥å¢å¼ºæç¤ºã€‚ çŸ¢é‡æ•°æ®åº“å·¥å…·ï¼ˆä¾‹å¦‚ [Azure å‘é‡æœç´¢](https://learn.microsoft.com/azure/search/vector-search-overview?WT.mc_id=academic-105485-koreyst)ï¼‰æ”¯æŒæ­¤åŠŸèƒ½ï¼Œå¯æ£€ç´¢æœ‰ç”¨çš„ä¿¡æ¯æ¥è‡ªå„ç§é¢„å®šä¹‰æ•°æ®æºçš„å—å¹¶å°†å®ƒä»¬æ·»åŠ åˆ°æç¤ºä¸Šä¸‹æ–‡ä¸­ã€‚

å½“ä¼ä¸šæ²¡æœ‰è¶³å¤Ÿçš„æ•°æ®ã€è¶³å¤Ÿçš„æ—¶é—´æˆ–èµ„æºæ¥å¾®è°ƒ LLMsï¼Œä½†ä»å¸Œæœ›æé«˜ç‰¹å®šå·¥ä½œè´Ÿè½½çš„æ€§èƒ½å¹¶å‡å°‘å¹»è§‰çš„é£é™©ï¼ˆå³å¯¹ç°å®çš„ç¥ç§˜åŒ–æˆ–æœ‰å®³çš„å†…å®¹ï¼‰æ—¶ï¼Œæ­¤æŠ€æœ¯éå¸¸æœ‰ç”¨ã€‚

### å¾®è°ƒæ¨¡å‹

å¾®è°ƒæ˜¯ä¸€ä¸ªåˆ©ç”¨è¿ç§»å­¦ä¹ ä½¿æ¨¡å‹â€œé€‚åº”â€ä¸‹æ¸¸ä»»åŠ¡æˆ–è§£å†³ç‰¹å®šé—®é¢˜çš„è¿‡ç¨‹ã€‚ ä¸å°‘æ ·æœ¬å­¦ä¹ å’Œ RAG ä¸åŒï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªæ–°æ¨¡å‹ï¼Œå¹¶æ›´æ–°æƒé‡å’Œåå·®ã€‚ å®ƒéœ€è¦ä¸€ç»„è®­ç»ƒç¤ºä¾‹ï¼Œå…¶ä¸­åŒ…å«å•ä¸ªè¾“å…¥ï¼ˆæç¤ºï¼‰åŠå…¶å…³è”çš„è¾“å‡ºï¼ˆå®Œæˆï¼‰ã€‚

å¦‚æœå‡ºç°ä»¥ä¸‹æƒ…å†µï¼Œè¿™å°†æ˜¯é¦–é€‰æ–¹æ³•ï¼š

- **ä½¿ç”¨å¾®è°ƒæ¨¡å‹**ã€‚ ä¼ä¸šå¸Œæœ›ä½¿ç”¨ç»è¿‡å¾®è°ƒèƒ½åŠ›è¾ƒå·®çš„æ¨¡å‹ï¼ˆä¾‹å¦‚åµŒå…¥æ¨¡å‹ï¼‰è€Œä¸æ˜¯é«˜æ€§èƒ½æ¨¡å‹ï¼Œä»è€Œè·å¾—æ›´å…·æˆæœ¬æ•ˆç›Šå’Œå¿«é€Ÿçš„è§£å†³æ–¹æ¡ˆã€‚
- **è€ƒè™‘å»¶è¿Ÿ**ã€‚ å»¶è¿Ÿå¯¹äºç‰¹å®šç”¨ä¾‹å¾ˆé‡è¦ï¼Œå› æ­¤ä¸å¯èƒ½ä½¿ç”¨å¾ˆé•¿çš„æç¤ºï¼Œæˆ–è€…åº”è¯¥ä»æ¨¡å‹ä¸­å­¦ä¹ çš„ç¤ºä¾‹æ•°é‡ä¸ç¬¦åˆæç¤ºé•¿åº¦é™åˆ¶ã€‚
- **ä¿æŒæœ€æ–°çŠ¶æ€**ã€‚ ä¼ä¸šæ‹¥æœ‰å¤§é‡é«˜è´¨é‡çš„æ•°æ®å’ŒçœŸå®æ ‡ç­¾ï¼Œä»¥åŠéšç€æ—¶é—´çš„æ¨ç§»ä¿æŒè¿™äº›æ•°æ®æœ€æ–°æ‰€éœ€çš„èµ„æºã€‚

### è®­ç»ƒå‚ç›´è¡Œä¸šæ¨¡å‹

ä»å¤´å¼€å§‹åŸ¹è®­ LLMs æ— ç–‘æ˜¯æœ€å›°éš¾ã€æœ€å¤æ‚çš„æ–¹æ³•ï¼Œéœ€è¦å¤§é‡æ•°æ®ã€ç†Ÿç»ƒèµ„æºå’Œé€‚å½“çš„è®¡ç®—èƒ½åŠ›ã€‚ ä»…åœ¨ä¼ä¸šå…·æœ‰ç‰¹å®šé¢†åŸŸçš„ç”¨ä¾‹å’Œå¤§é‡ä»¥ç‰¹å®šé¢†åŸŸä¸ºä¸­å¿ƒçš„æ•°æ®çš„æƒ…å†µä¸‹æ‰åº”è€ƒè™‘æ­¤é€‰é¡¹ã€‚

> å¦‚æœæ‚¨æœ‰æ—¶é—´å’Œèµ„æºä»¥åŠé«˜è´¨é‡çš„æ•°æ®ï¼Œå¾®è°ƒæ˜¯ä¿æŒæœ€æ–°çŠ¶æ€çš„æ›´å¥½é€‰æ‹©ã€‚ ç„¶è€Œï¼Œå¦‚æœæ‚¨æ­£åœ¨å¯»æ±‚æ”¹è¿›ï¼Œä½†åˆç¼ºä¹æ—¶é—´ï¼Œé‚£ä¹ˆå€¼å¾—é¦–å…ˆè€ƒè™‘ RAGã€‚

## æ‹“å±•å­¦ä¹ èµ„æº

ğŸ”— [How to use Open Source foundation models curated by Azure Machine Learning (preview) - Azure Machine Learning | Microsoft Learn](https://learn.microsoft.com/azure/machine-learning/how-to-use-foundation-models?WT.mc_id=academic-105485-koreyst)

ğŸ”— [The Large Language Model (LLM) Index | Sapling](https://sapling.ai/llm/index?WT.mc_id=academic-105485-koreyst)

ğŸ”— [[2304.04052\] Decoder-Only or Encoder-Decoder? Interpreting Language Model as a Regularized Encoder-Decoder (arxiv.org)](https://arxiv.org/abs/2304.04052?WT.mc_id=academic-105485-koreyst)

ğŸ”— [Retrieval Augmented Generation using Azure Machine Learning prompt flow](https://learn.microsoft.com/azure/machine-learning/concept-retrieval-augmented-generation?WT.mc_id=academic-105485-koreyst)

ğŸ”— [Grounding LLMs](https://techcommunity.microsoft.com/t5/fasttrack-for-azure/grounding-llms/ba-p/3843857?wt.mc_id=github_S-1231_webpage_reactor)

ğŸ”— [The Large Language Model (LLM) Index | Sapling](https://sapling.ai/llm/index?wt.mc_id=github_S-1231_webpage_reactor)

ğŸ”— [[2304.04052\] Decoder-Only or Encoder-Decoder? Interpreting Language Model as a Regularized Encoder-Decoder (arxiv.org)](https://arxiv.org/abs/2304.04052?wt.mc_id=github_S-1231_webpage_reactor)
